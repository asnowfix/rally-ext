<link rel="import" href="setting-section.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<dom-module id="copy-to-clipboard">
  <style>
    .refresh {
      max-width: 200px
    }
    .settingBox {
      margin-bottom: 15px;
    }
    .description {
      font-size: 14px;
      padding: 12px 10px 10px 20px;
    }
  </style>
  <template>
    <setting-section id="section" notresetable sectionname="Copy To Clipboard"
      on-save="save">
      <div class="settingBox layout horizontal">
        <paper-input id="refresh" class="refresh"
          label=""
          type="number"
          value="{{formatToSeconds(conf.injectionInterval)}}"></paper-input>
          <div class="flex description">
            The frequency the extension will look for links
             and add the copy-to-clipboard icon next to it.<br/>
            With a smaller value, the icons will appear quicker but it can affect performance (not measured)
          </div>
      </div>
      <div class="settingBox layout horizontal">
        <paper-input id="fadeaway" class="refresh"
          label=""
          type="number"
          value="{{formatToSeconds(conf.checkMarkFadeAwayDelay)}}"></paper-input>
          <div class="flex description">
            The time needed for the check mark to dissapear after the icon has been clicked.
          </div>
      </div>
    </setting-section>
</template>
</dom>
<script>
  Polymer({
    is: 'copy-to-clipboard',
    properties: {
      conf: {
        type: Object,
        observer: "doLabels",
        notify:true
      }
    },
    formatToSeconds: function(val) {
      return Math.round(val/100)/10;
    },
    save: function(e) {
      e.detail.section="copyToClipboard";
      var injectionInt = Math.round(Number.parseInt(this.$.refresh.value,10)*10)*100
        , fadedelay = Math.round(Number.parseInt(this.$.fadeaway.value,10)*10)*100
        ;
      this.conf.injectionInterval = injectionInt;
      this.conf.checkMarkFadeAwayDelay = fadedelay;
    },

    doLabels: function(newVal) {
      this.$.refresh.label= "Previous value: "+this.formatToSeconds(newVal.injectionInterval) + " sec";
      this.$.fadeaway.label= "Previous value: "+this.formatToSeconds(newVal.checkMarkFadeAwayDelay) + " sec";
    },
    // Element Lifecycle
    ready: function() {
    },
    highlightSection: function(toggle) {
      return function() {
        this.$.section.highlighted = toggle;
      }
    },
    attached: function() {
      var focusers = Polymer.dom(this).querySelectorAll('.focuser')
        ;
      this.$.refresh.$.input.addEventListener('focus',this.highlightSection(true).bind(this))
      this.$.refresh.$.input.addEventListener('blur',this.highlightSection(false).bind(this))
      this.$.fadeaway.$.input.addEventListener('focus',this.highlightSection(true).bind(this))
      this.$.fadeaway.$.input.addEventListener('blur',this.highlightSection(false).bind(this))
    },
    detached: function() {
    },
  });
</script>
